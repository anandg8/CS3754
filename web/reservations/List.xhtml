<?xml version="1.0" encoding="UTF-8" ?>
<!--
Created by Amit Dayal on 2017.12.11
Copyright Â© 2017 Amit Dayal. All rights reserved.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    
    
    <ui:composition template="/template/siteTemplate.xhtml">
        <ui:define name="title">
            <h:outputText value="#{bundle.ListDishTitle}"></h:outputText>
        </ui:define>
        <!-- 
        
            This table gets all the current reservations for the current user. There are two categories of
            reservations: current and previous. In the first tab, we show current reservations, and in the second tab
            we show the previous reservations. We know the previous reservations are 'previous' since the date of their
            meal time is past the current time vs having a time in the future.
        
            If a meal has yet to occur (it's a current reservation), the user can View the dish or refund.
            If a meal has already occurred (It's a past reservation), the user can View and rate.
        
        -->
        <ui:define name="editableContent">
            <p:growl id="growl" life="5000" />
            <h:form id="DishListForm">
                <p:tabView>
                    <p:tab title="Current Reservations">
                        <p:panel header="Current Reservations">
                            <!-- Create a datatable with all the current reservations for the logged in user -->
                            <p:dataTable id="datalist" value="#{dishController.getCurrentReservations()}" var="item"
                                         selectionMode="single" selection="#{dishController.selected}"
                                         paginator="true"
                                         rowKey="#{item.id}"
                                         rows="10"
                                         widgetVar="currentReservations"
                                         rowsPerPageTemplate="10,20,30,40,50"
                                         >


                            <p:column exportable="false" style="width:120px;">
                            <f:facet name="header">
                                <h:outputText value="Picture"/>
                            </f:facet>
                            <div align="center">
                                <h:graphicImage value="#{item.dishPicturePath}"
                                                width="100px" height="100px" />
                            </div>
                        </p:column>
                                <p:column sortBy="#{item.dishName}">
                            <div align="center">
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDishTitle_name}"/>
                            </f:facet>
                                <h:outputText value="#{item.dishName}"/>
                            </div>
                        </p:column>
                        <p:column>
                            <div align="center">
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDishTitle_description}"/>
                            </f:facet>
                            <h:outputText value="#{item.description}"/>
                            </div>
                        </p:column>
                        <p:column sortBy="#{item.cuisineId.name}">
                            <div align="center">
                            <f:facet name="header">
                                <h:outputText value="Cuisine"/>
                            </f:facet>
                            <h:outputText value="#{item.cuisineId.name}" />
                            </div>
                        </p:column>
                        <p:column sortBy="#{item.userId.username}">
                            <div align="center">
                            <f:facet name="header">
                                <h:outputText value="Cook User ID"/>
                            </f:facet>
                            <h:outputText value="#{item.userId.username}" />
                            </div>
                        </p:column>
                        <p:column sortBy="#{item.cost}">
                            <div align="center">
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDishTitle_cost}"/>
                            </f:facet>
                            <h:outputText value="#{item.cost}"/>
                            </div>
                        </p:column>
                        <p:column sortBy="#{item.reservationTime}">
                            <div align="center">
                                <f:facet name="header">
                                    <h:outputText value="#{bundle.ListDishTitle_reservationTime}"/>
                                </f:facet>
                                <h:outputText value="#{item.reservationTime}">
                                    <f:convertDateTime pattern="MM/dd/yyyy" />
                                </h:outputText>
                                <br />
                                <br />
                                <h:outputText value="#{item.reservationTime}">
                                    <f:convertDateTime pattern="h:mm a" />
                                </h:outputText>
                            </div>
                        </p:column>
                        <p:column sortBy="#{item.mealTime}">
                            <div align="center">
                                <f:facet name="header">
                                    <h:outputText value="#{bundle.ListDishTitle_mealTime}"/>
                                </f:facet>
                                <h:outputText value="#{item.mealTime}">
                                    <f:convertDateTime pattern="MM/dd/yyyy" />
                                </h:outputText>
                                <br />
                                <br />
                                <h:outputText value="#{item.mealTime}">
                                    <f:convertDateTime pattern="h:mm a" />
                                </h:outputText>
                            </div>
                        </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>
                    <p:tab title="Previous Reservations">
                        <p:panel header="Previous Reservations">
                            <!-- Create a datatable with all the previous reservations for the logged in user -->
                            <p:dataTable id="datalistPrevious" value="#{dishController.getPastReservations()}" var="item"
                                         selectionMode="single" selection="#{dishController.selected}"
                                         paginator="true"
                                         rowKey="#{item.id}"
                                         rows="10"
                                         widgetVar="previousReservations"
                                         rowsPerPageTemplate="10,20,30,40,50"
                                         >
                                         <p:ajax event="rowSelect"   update="viewButton"/>
                                         <p:ajax event="rowUnselect" update="viewButton"/>
                                         
                               <p:column exportable="false" style="width:120px;">
                            <f:facet name="header">
                                <h:outputText value="Picture"/>
                            </f:facet>
                            <div align="center">
                                <h:graphicImage value="#{item.dishPicturePath}"
                                                width="100px" height="100px" />
                            </div>
                        </p:column>
                                         <p:column sortBy="#{item.dishName}">
                            <div align="center">
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDishTitle_name}"/>
                            </f:facet>
                                <h:outputText value="#{item.dishName}"/>
                            </div>
                        </p:column>
                        <p:column>
                            <div align="center">
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDishTitle_description}"/>
                            </f:facet>
                            <h:outputText value="#{item.description}"/>
                            </div>
                        </p:column>
                        <p:column sortBy="#{item.cuisineId.name}">
                            <div align="center">
                            <f:facet name="header">
                                <h:outputText value="Cuisine"/>
                            </f:facet>
                            <h:outputText value="#{item.cuisineId.name}" />
                            </div>
                        </p:column>
                        <p:column sortBy="#{item.userId.username}">
                            <div align="center">
                            <f:facet name="header">
                                <h:outputText value="Cook User ID"/>
                            </f:facet>
                            <h:outputText value="#{item.userId.username}" />
                            </div>
                        </p:column>
                        <p:column sortBy="#{item.cost}">
                            <div align="center">
                            <f:facet name="header">
                                <h:outputText value="#{bundle.ListDishTitle_cost}"/>
                            </f:facet>
                            <h:outputText value="#{item.cost}"/>
                            </div>
                        </p:column>
                        <p:column sortBy="#{item.reservationTime}">
                            <div align="center">
                                <f:facet name="header">
                                    <h:outputText value="#{bundle.ListDishTitle_reservationTime}"/>
                                </f:facet>
                                <h:outputText value="#{item.reservationTime}">
                                    <f:convertDateTime pattern="MM/dd/yyyy" />
                                </h:outputText>
                                <br />
                                <br />
                                <h:outputText value="#{item.reservationTime}">
                                    <f:convertDateTime pattern="h:mm a" />
                                </h:outputText>
                            </div>
                        </p:column>
                        <p:column sortBy="#{item.mealTime}">
                            <div align="center">
                                <f:facet name="header">
                                    <h:outputText value="#{bundle.ListDishTitle_mealTime}"/>
                                </f:facet>
                                <h:outputText value="#{item.mealTime}">
                                    <f:convertDateTime pattern="MM/dd/yyyy" />
                                </h:outputText>
                                <br />
                                <br />
                                <h:outputText value="#{item.mealTime}">
                                    <f:convertDateTime pattern="h:mm a" />
                                </h:outputText>
                            </div>
                        </p:column>
                            <f:facet name="footer">
                                <p:commandButton id="viewButton"   icon="ui-icon-search" value="#{bundle.View}" update=":DishViewForm" oncomplete="PF('DishViewDialogPastReservations').show()" disabled="#{empty dishController.selected}"/>
                            </f:facet>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>
                </p:tabView>
            </h:form>
            <ui:include src="ViewAndRefund.xhtml"/>
            <ui:include src="ViewAndRate.xhtml"/>
        </ui:define>
    </ui:composition>

</html>
